<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lectorium - Biblioteca Digital I.E. Luis Carlos López</title>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- CSS Files -->
  <link rel="stylesheet" href="css/main.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo-section">
          <div class="logo-icon">
            <i class="fas fa-university"></i>
          </div>
          <div class="logo-text">
            <h1>Lectorium</h1>
            <p>Biblioteca Digital - I.E. Luis Carlos López</p>
          </div>
        </div>
        
        <nav class="nav-actions">
          <button class="btn btn-icon" id="themeToggle">
            <i class="fas fa-moon"></i>
          </button>
          
          <button class="btn btn-icon" id="notificationBtn">
            <i class="fas fa-bell"></i>
          </button>
          
          <!-- Login Button -->
          <button class="btn btn-primary" id="loginBtn">
            <i class="fas fa-sign-in-alt"></i>
            <span>Iniciar Sesión</span>
          </button>
          
          <!-- User Menu -->
          <div class="user-menu" id="userMenu" style="display: none;">
            <div class="user-info" id="userInfo">
              <div class="user-avatar" id="userAvatar">U</div>
              <span id="userName">Usuario</span>
              <i class="fas fa-chevron-down"></i>
            </div>
            <div class="user-dropdown" id="userDropdown">
              <button class="dropdown-item" id="profileBtn">
                <i class="fas fa-user"></i>
                <span>Mi Perfil</span>
              </button>
              <button class="dropdown-item" id="historyBtn">
                <i class="fas fa-history"></i>
                <span>Historial</span>
              </button>
              <div class="dropdown-divider"></div>
              <button class="dropdown-item" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Cerrar Sesión</span>
              </button>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <!-- Dashboard -->
      <div id="dashboardContent" class="content-section">
        <div class="welcome-card">
          <h2>Bienvenido a Lectorium</h2>
          <p id="welcomeMessage">Sistema de gestión bibliotecaria digital</p>
          
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="totalBooks">0</div>
              <div class="stat-label">Libros Digitales</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="availableBooks">0</div>
              <div class="stat-label">Disponibles</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="activeLoans">0</div>
              <div class="stat-label">Préstamos Activos</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">24/7</div>
              <div class="stat-label">Acceso</div>
            </div>
          </div>
        </div>

        <div class="dashboard-grid">
          <div class="card">
            <h3 class="card-title">Acciones Rápidas</h3>
            <div class="quick-actions">
              <button class="btn btn-primary btn-full" id="searchBooksBtn">
                <i class="fas fa-search"></i>
                Buscar Libros
              </button>
              <button class="btn btn-secondary btn-full" id="myLoansBtn">
                <i class="fas fa-book-reader"></i>
                Mis Préstamos
              </button>
            </div>
          </div>
          
          <div class="card">
            <h3 class="card-title">Novedades</h3>
            <p class="card-description">
              Últimas actualizaciones:
            </p>
            <ul class="news-list" id="newsList">
              <li>Cargando...</li>
            </ul>
          </div>
        </div>

        <!-- Admin Panel (solo visible para administradores) -->
        <div id="adminPanel" class="card" style="display: none; margin-top: 2rem;">
          <h3 class="card-title">Panel de Administración</h3>
          <div class="admin-stats">
            <p>Total de usuarios: <span id="totalUsers">0</span></p>
            <p>Usuarios activos hoy: <span id="activeToday">0</span></p>
          </div>
          <button class="btn btn-primary" id="manageUsersBtn">
            <i class="fas fa-users"></i>
            Gestionar Usuarios
          </button>
        </div>
      </div>

      <!-- Public Content -->
      <div id="publicContent" class="content-section active">
        <div class="welcome-card">
          <h2>Bienvenido a Lectorium</h2>
          <p>Accede con tu cuenta institucional para explorar nuestra biblioteca digital</p>
          
          <button class="btn btn-primary btn-center" onclick="document.getElementById('loginBtn').click()">
            <i class="fas fa-sign-in-alt"></i>
            Iniciar Sesión
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- Auth Modal -->
  <div id="authModal" class="modal-overlay">
    <div class="auth-modal">
      <div class="auth-header">
        <div class="auth-icon">
          <i class="fas fa-book-open"></i>
        </div>
        <h2 class="auth-title" id="authTitle">Iniciar Sesión</h2>
        <p class="auth-subtitle" id="authSubtitle">Accede a la biblioteca digital</p>
      </div>
      
      <div class="auth-body">
        <div id="authAlert"></div>
        
        <form id="authForm">
          <!-- Name field -->
          <div class="form-group" id="nameGroup" style="display: none;">
            <label class="form-label" for="fullName">Nombre completo</label>
            <div class="input-wrapper">
              <i class="fas fa-user input-icon"></i>
              <input type="text" id="fullName" class="form-input" placeholder="Juan Pérez">
            </div>
          </div>
          
          <!-- Email field -->
          <div class="form-group">
            <label class="form-label" for="email">Correo electrónico</label>
            <div class="input-wrapper">
              <i class="fas fa-envelope input-icon"></i>
              <input type="email" id="email" class="form-input" placeholder="correo@ieluiscarloslopez.edu.co" required>
            </div>
            <p class="form-hint">Solo correos institucionales @ieluiscarloslopez.edu.co</p>
          </div>
          
          <!-- Password field -->
          <div class="form-group">
            <label class="form-label" for="password">Contraseña</label>
            <div class="input-wrapper">
              <i class="fas fa-lock input-icon"></i>
              <input type="password" id="password" class="form-input" placeholder="••••••••" required>
              <button type="button" class="password-toggle" id="togglePassword">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          
          <!-- Confirm password -->
          <div class="form-group" id="confirmGroup" style="display: none;">
            <label class="form-label" for="confirmPassword">Confirmar contraseña</label>
            <div class="input-wrapper">
              <i class="fas fa-lock input-icon"></i>
              <input type="password" id="confirmPassword" class="form-input" placeholder="••••••••">
              <button type="button" class="password-toggle" id="toggleConfirm">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>

          <!-- Forgot Password Link -->
          <div class="form-group" id="forgotPasswordGroup">
            <a href="#" id="forgotPasswordLink" class="forgot-link">¿Olvidaste tu contraseña?</a>
          </div>
        </form>
      </div>
      
      <div class="auth-footer">
        <button type="submit" form="authForm" class="btn btn-primary btn-full" id="authSubmit">
          <span id="submitText">Iniciar Sesión</span>
        </button>
        
        <div class="auth-switch">
          <span id="switchText">¿No tienes cuenta?</span>
          <a href="#" id="authSwitch">Regístrate</a>
        </div>
        
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary" id="closeModal">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Firebase SDK v9 (Modular) -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
    import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';

    // Make Firebase available globally
    window.firebaseModules = {
      initializeApp,
      getAuth,
      getFirestore,
      getAnalytics
    };
  </script>

  <!-- JavaScript Files -->
  <script src="js/utils.js"></script>
  <script src="js/notifications.js"></script>
  <script src="js/ui.js"></script>
  <script type="module" src="js/firebase-config.js"></script>
  <script type="module" src="js/database.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module" src="js/main.js"></script>
</body>
</html>